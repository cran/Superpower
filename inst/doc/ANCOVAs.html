<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Aaron R. Caldwell" />


<title>Power Calculations for ANCOVA</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Power Calculations for ANCOVA</h1>
<h4 class="author">Aaron R. Caldwell</h4>
<h4 class="date">24 June, 2025</h4>


<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#one-way-ancova" id="toc-one-way-ancova">One-way ANCOVA</a>
<ul>
<li><a href="#cohen_book-method" id="toc-cohen_book-method"><span class="citation">Cohen (1988)</span> Method</a></li>
<li><a href="#shieh_ancova-method" id="toc-shieh_ancova-method"><span class="citation">Shieh (2020)</span> Method</a></li>
</ul></li>
<li><a href="#extending-to-factorial-anovas" id="toc-extending-to-factorial-anovas">Extending to factorial ANOVAs</a>
<ul>
<li><a href="#ancova_analytic" id="toc-ancova_analytic">ANCOVA_analytic</a>
<ul>
<li><a href="#example-2x3-design" id="toc-example-2x3-design">Example:
2x3 Design</a></li>
</ul></li>
</ul></li>
<li><a href="#contrasts" id="toc-contrasts">Contrasts</a></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</div>

<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;Superpower&quot;</span>)</span></code></pre></div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Recently, <span class="citation">Shieh (<a href="#ref-shieh_ancova">2020</a>)</span> demonstrated that most
software uses a slightly flawed approach to estimating power for
ANCOVAs, and focused on one-way ANOVA designs to compare his method to
the method first mentioned by <span class="citation">Cohen (<a href="#ref-cohen_book">1988</a>)</span>.</p>
</div>
<div id="one-way-ancova" class="section level1">
<h1>One-way ANCOVA</h1>
<p>As <span class="citation">Shieh (<a href="#ref-shieh_ancova">2020</a>)</span> eloquently points out in their
simulations, the method of <span class="citation">Cohen (<a href="#ref-cohen_book">1988</a>)</span> overestimates power and the
problem is exacerbated by having a high number of covariates with high
proportion of the variance (<span class="math inline">\(R^2\)</span>)
explained by the covariates. The problem is worst (30% error between
estimated and actual power) in the simulation when there are 10
covariates included in the model when explained variance is
approximately 81% (<span class="math inline">\(\rho = 0.9\)</span>)
[<span class="citation">Shieh (<a href="#ref-shieh_ancova">2020</a>)</span> see Table 3). While this may
not seem like much of issue if you don’t expect to encounter this
scenario, it still demonstrates the <span class="citation">Cohen (<a href="#ref-cohen_book">1988</a>)</span> method is inconsistent in
producing appropriate estimates of power. I believe this is reason
enough (when provided with a sustainable and implementable alternative)
to abandon the old method of <span class="citation">Cohen (<a href="#ref-cohen_book">1988</a>)</span> for a newer method that provides
exact, rather than approximate, estimates of power for ANCOVA.</p>
<p>Thankfully, <span class="citation">Shieh (<a href="#ref-shieh_ancova">2020</a>)</span> was diligent in his work and
demonstrated, showing both the math and simulations, how a new exact
method could be utilized. The direct method described in the paper is
implemented in the <code>power_oneway_ancova</code> function.</p>
<p>We can copy the example from <span class="citation">Maxwell and
Delaney (<a href="#ref-maxwell_delaney">2004</a>)</span> that Shieh also
used. In this example there are 3 groups with means (<code>mu</code>) of
400, 450, 500 respectively. The error variance is 10000
(<code>sd = 100</code>). Rather than simulating dozens of examples, I
will demonstrate one scenario below where there are 3 covariates, and
the <span class="math inline">\(R^2\)</span> (treatment effect excluded)
is equal to 0.25 (<span class="math inline">\(\rho = 0.5\)</span>). This
is demonstrated in <span class="citation">Shieh (<a href="#ref-shieh_ancova">2020</a>)</span>, Table 2.</p>
<p>For <code>power_oneway_ancova</code> we can demonstrate both the
approximate and exact methods using the <code>type</code> argument. We
can leave the <code>n</code> argument out in order to solve for the
sample size required to reach 80% power. Please notice that
<code>round_up</code> is set to TRUE since we want have a whole number
for sample sizes (rather than a fractional sample size).</p>
<div id="cohen_book-method" class="section level2">
<h2><span class="citation">Cohen (<a href="#ref-cohen_book">1988</a>)</span> Method</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">power_oneway_ancova</span>(</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">400</span>,<span class="dv">450</span>,<span class="dv">500</span>),</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">n_cov =</span> <span class="dv">3</span>,</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="at">sd =</span> <span class="dv">100</span>,</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="at">r2 =</span> .<span class="dv">25</span>,</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="at">alpha_level =</span> .<span class="dv">05</span>,</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  <span class="co">#n = c(17,17,17),</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="at">beta_level =</span> .<span class="dv">2</span>,</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  <span class="at">round_up =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;approx&quot;</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>#&gt; 
#&gt;      Power Calculation for 1-way ANCOVA 
#&gt; 
#&gt;             dfs = 2, 42
#&gt;               N = 48
#&gt;               n = 16, 16, 16
#&gt;           n_cov = 3
#&gt;              mu = 400, 450, 500
#&gt;              sd = 100
#&gt;              r2 = 0.25
#&gt;     alpha_level = 0.05
#&gt;      beta_level = 0.1877374
#&gt;           power = 81.22626
#&gt;            type = approx</code></pre>
</div>
<div id="shieh_ancova-method" class="section level2">
<h2><span class="citation">Shieh (<a href="#ref-shieh_ancova">2020</a>)</span> Method</h2>
<p>Notice that this method requires 3 more subjects in order to achieve
a minimum of 80% power.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">power_oneway_ancova</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">400</span>,<span class="dv">450</span>,<span class="dv">500</span>),</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="at">n_cov =</span> <span class="dv">3</span>,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="at">sd =</span> <span class="dv">100</span>,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="at">r2 =</span> .<span class="dv">25</span>,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="at">alpha_level =</span> .<span class="dv">05</span>,</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="co">#n = c(17,17,17),</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  <span class="at">beta_level =</span> .<span class="dv">2</span>,</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>  <span class="at">round_up =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;exact&quot;</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>#&gt; 
#&gt;      Power Calculation for 1-way ANCOVA 
#&gt; 
#&gt;             dfs = 2, 45
#&gt;               N = 51
#&gt;               n = 17, 17, 17
#&gt;           n_cov = 3
#&gt;              mu = 400, 450, 500
#&gt;              sd = 100
#&gt;              r2 = 0.25
#&gt;     alpha_level = 0.05
#&gt;      beta_level = 0.1878274
#&gt;           power = 81.21726
#&gt;            type = exact</code></pre>
</div>
</div>
<div id="extending-to-factorial-anovas" class="section level1">
<h1>Extending to factorial ANOVAs</h1>
<p>Now, <span class="citation">Shieh (<a href="#ref-shieh_ancova">2020</a>)</span> mentioned something very
interesting at the end of section 3.</p>
<blockquote>
<p>“Although the prescribed application of general linear hypothesis is
discussed only from the perspective of a one-way ANCOVA design, the
number of groups G may also represent the total number of combined
factor levels of a multi-factor ANCOVA design. Hence, using a contrast
matrix associated with a specific designated hypothesis, the same
concept and process of assessing treatment effects can be readily
extended to two-way and higher-order ANCOVA designs.”</p>
</blockquote>
<p>Therefore, all that is needed to extend the one-way ANOVA code
provided by <span class="citation">Shieh (<a href="#ref-shieh_ancova">2020</a>)</span> is to provide the appropriate
contrast matrix for the main effect or interaction ANOVA-level effect
that is desired. <code>Superpower</code> accomplishes this with the
<code>ANCOVA_analytic</code> function which internally uses the
<code>model.matrix</code> function to form the appropriate contrast
matrix.</p>
<div id="ancova_analytic" class="section level2">
<h2>ANCOVA_analytic</h2>
<p>This function operates similar to the <code>ANOVA_power</code> and
<code>ANOVA_exact</code> functions. However, the
<code>ANCOVA_analytic</code> function doesn’t require the use of
<code>ANOVA_design</code> first and relies upon the closed formulas from
<span class="citation">Shieh (<a href="#ref-shieh_ancova">2020</a>)</span> rather than a simulation to
calculate statistical power. Please note that unlike the
<code>power_oneway_ancova</code> function there is no option to apply
the approximation from <span class="citation">Cohen (<a href="#ref-cohen_book">1988</a>)</span> for factorial designs.</p>
<div id="example-2x3-design" class="section level3">
<h3>Example: 2x3 Design</h3>
<p>We can extend the previous scenario with 3 groups to a factorial
design with 2 groups across 3 conditions.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Run function</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>res1 <span class="ot">=</span> <span class="fu">ANCOVA_analytic</span>(</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="at">design =</span> <span class="st">&quot;2b*3b&quot;</span>,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">400</span>, <span class="dv">450</span>, <span class="dv">500</span>,</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>         <span class="dv">400</span>, <span class="dv">500</span>, <span class="dv">600</span>),</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="at">n_cov =</span> <span class="dv">3</span>,</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  <span class="at">sd =</span> <span class="dv">100</span>,</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  <span class="at">r2 =</span> .<span class="dv">25</span>,</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  <span class="at">alpha_level =</span> .<span class="dv">05</span>,</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>  <span class="co">#n = 17,</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  <span class="at">beta_level =</span> .<span class="dv">2</span>,</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>  <span class="at">round_up =</span> <span class="cn">TRUE</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>)</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co"># Print main results</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>res1</span></code></pre></div>
<pre><code>#&gt; Power Analysis Results for ANCOVA
#&gt;     Total N Covariates   r2 Alpha Level Beta Level Power
#&gt; a       102          3 0.25        0.05     0.1897 81.03
#&gt; b        30          3 0.25        0.05     0.1389 86.11
#&gt; a:b     180          3 0.25        0.05     0.1995 80.05</code></pre>
<p>The results can also be printed as <code>power.htest</code> objects
by accessing the individual effects in the <code>res1</code> object.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>res1<span class="sc">$</span>aov_list<span class="sc">$</span>a</span></code></pre></div>
<pre><code>#&gt; 
#&gt;      Power Calculation for ANCOVA 
#&gt; 
#&gt;             dfs = 1, 93
#&gt;               N = 102
#&gt;               n = 17, 17, 17, 17, 17, 17
#&gt;           n_cov = 3
#&gt;              mu = 400, 450, 500, 400, 500, 600
#&gt;              sd = 100
#&gt;              r2 = 0.25
#&gt;     alpha_level = 0.05
#&gt;      beta_level = 0.1897221
#&gt;           power = 81.02779
#&gt;            type = Exact</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>res1<span class="sc">$</span>aov_list<span class="sc">$</span>b</span></code></pre></div>
<pre><code>#&gt; 
#&gt;      Power Calculation for ANCOVA 
#&gt; 
#&gt;             dfs = 2, 21
#&gt;               N = 30
#&gt;               n = 5, 5, 5, 5, 5, 5
#&gt;           n_cov = 3
#&gt;              mu = 400, 450, 500, 400, 500, 600
#&gt;              sd = 100
#&gt;              r2 = 0.25
#&gt;     alpha_level = 0.05
#&gt;      beta_level = 0.1389288
#&gt;           power = 86.10712
#&gt;            type = Exact</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>res1<span class="sc">$</span>aov_list<span class="sc">$</span>ab</span></code></pre></div>
<pre><code>#&gt; 
#&gt;      Power Calculation for ANCOVA 
#&gt; 
#&gt;             dfs = 2, 171
#&gt;               N = 180
#&gt;               n = 30, 30, 30, 30, 30, 30
#&gt;           n_cov = 3
#&gt;              mu = 400, 450, 500, 400, 500, 600
#&gt;              sd = 100
#&gt;              r2 = 0.25
#&gt;     alpha_level = 0.05
#&gt;      beta_level = 0.1994719
#&gt;           power = 80.05281
#&gt;            type = Exact</code></pre>
<p>We can also check the design by using the plot method.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">plot</span>(res1)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>However, you may want to compare the power of ANOVA to an ANCOVA. In
that case you can use the <code>ANOVA_design</code> function and pass it
onto the <code>ANCOVA_analytic</code> function. But, this forces you to
set the sample size.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>des1 <span class="ot">=</span> <span class="fu">ANOVA_design</span>(  <span class="at">design =</span> <span class="st">&quot;2b*3b&quot;</span>,</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">400</span>, <span class="dv">450</span>, <span class="dv">500</span>,</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>         <span class="dv">400</span>, <span class="dv">500</span>, <span class="dv">600</span>),</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">17</span>,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="at">sd =</span> <span class="dv">100</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>res2 <span class="ot">=</span> <span class="fu">ANCOVA_analytic</span>(</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  <span class="at">design_result =</span> des1,</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  <span class="at">n_cov =</span> <span class="dv">3</span>,</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  <span class="at">r2 =</span> .<span class="dv">25</span>,</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  <span class="at">alpha_level =</span> .<span class="dv">05</span>,</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>  <span class="at">round_up =</span> <span class="cn">TRUE</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>)</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>res2</span></code></pre></div>
<pre><code>#&gt; Power Analysis Results for ANCOVA
#&gt;     Total N Covariates   r2 Alpha Level Beta Level Power
#&gt; a       102          3 0.25        0.05  0.1897221 81.03
#&gt; b       102          3 0.25        0.05  0.0001954 99.98
#&gt; a:b     102          3 0.25        0.05  0.4701157 52.99</code></pre>
</div>
</div>
</div>
<div id="contrasts" class="section level1">
<h1>Contrasts</h1>
<p>User specified contrasts can also be used for a power analysis. These
can be provided in the <code>cmats</code> argument of the
<code>ANCOVA_analytic</code> function or supplied directly to the
<code>ANCOVA_contrast</code> function as an independent test. The
<code>ANCOVA_analytic</code> function requires that the contrasts
matrices are provided as matrices (i.e., <code>as.matrix</code>). The
contrasts can be accessed in the <code>con_list</code> part of the
results and can be named (in this case “test”).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">ANCOVA_analytic</span>(<span class="at">design =</span> <span class="st">&quot;2b&quot;</span>,</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>                <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>                <span class="at">n =</span> <span class="dv">15</span>,</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>                <span class="at">cmats =</span> <span class="fu">list</span>(<span class="at">test =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>                                              <span class="at">nrow =</span> <span class="dv">1</span>)),</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>                <span class="at">sd =</span> <span class="dv">1</span>,</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>                <span class="at">r2 =</span> .<span class="dv">2</span>,</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>                <span class="at">n_cov =</span> <span class="dv">1</span>)<span class="sc">$</span>con_list<span class="sc">$</span>test</span></code></pre></div>
<pre><code>#&gt; 
#&gt;      Power Calculation for ANCOVA contrast 
#&gt; 
#&gt;             dfs = 1, 27
#&gt;               N = 30
#&gt;               n = 15, 15
#&gt;           n_cov = 1
#&gt;        contrast = -1, 1
#&gt;              mu = 0, 1
#&gt;              sd = 1
#&gt;              r2 = 0.2
#&gt;     alpha_level = 0.05
#&gt;      beta_level = 0.1744293
#&gt;           power = 82.55707
#&gt;            type = Exact</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># Same result</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">ANCOVA_contrast</span>(<span class="at">cmat =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>                <span class="at">n =</span> <span class="dv">15</span>,</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>                <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>                <span class="at">sd =</span> <span class="dv">1</span>,</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>                <span class="at">r2 =</span> .<span class="dv">2</span>,</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>                <span class="at">n_cov =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>#&gt; 
#&gt;      Power Calculation for ANCOVA contrast 
#&gt; 
#&gt;             dfs = 1, 27
#&gt;               N = 30
#&gt;               n = 15, 15
#&gt;           n_cov = 1
#&gt;        contrast = -1, 1
#&gt;              mu = 0, 1
#&gt;              sd = 1
#&gt;              r2 = 0.2
#&gt;     alpha_level = 0.05
#&gt;      beta_level = 0.1744293
#&gt;           power = 82.55707
#&gt;            type = Exact</code></pre>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-cohen_book" class="csl-entry">
Cohen, J. 1988. <em>Statistical Power Analysis for the Behavioral
Sciences</em>. 2nd ed. <a href="https://doi.org/10.4324/9780203771587">https://doi.org/10.4324/9780203771587</a>.
</div>
<div id="ref-maxwell_delaney" class="csl-entry">
Maxwell, S.E., and H.D. Delaney. 2004. <em>Designing Experiments and
Analyzing Data: A Model Comparison Perspective</em>. 2nd ed. Mahwah, NJ:
Lawrence Erlbaum Associates.
</div>
<div id="ref-shieh_ancova" class="csl-entry">
Shieh, G. 2020. <span>“Power analysis and sample size planning in ANCOVA
designs.”</span> <em>Psychometrika</em> 85 (1): 101–20. <a href="https://doi.org/10.1007/s11336-019-09692-3">https://doi.org/10.1007/s11336-019-09692-3</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
