<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Frederik Aust" />


<title>Power calculations for emmeans analyses</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Power calculations for <code>emmeans</code>
analyses</h1>
<h4 class="author">Frederik Aust</h4>
<h4 class="date">24 June, 2025</h4>


<div id="TOC">
<ul>
<li><a href="#a-note-of-caution" id="toc-a-note-of-caution">A note of
caution</a></li>
<li><a href="#post-hoc-pairwise-comparisons" id="toc-post-hoc-pairwise-comparisons">Post hoc pairwise
comparisons</a></li>
<li><a href="#customized-emmeans-contrasts" id="toc-customized-emmeans-contrasts">Customized <code>emmeans</code>
contrasts</a>
<ul>
<li><a href="#equivalence-and-non-superiority-inferiority-tests" id="toc-equivalence-and-non-superiority-inferiority-tests">Equivalence
and non-superiority/-inferiority tests</a></li>
<li><a href="#joint-tests" id="toc-joint-tests">Joint tests</a></li>
</ul></li>
</ul>
</div>

<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;Superpower&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;emmeans&quot;</span>)</span></code></pre></div>
<pre><code>#&gt; Warning: package &#39;emmeans&#39; was built under R version 4.4.3</code></pre>
<p>When conducting exact ANOVA power analyses with
<code>Superpower</code> it is possible to calculate the power for both
the omnibus <span class="math inline">\(F\)</span>-tests and planned
contrasts or post-hoc comparisons. It is possible to use this approach
to calculate power for standard contrasts, such as pairwise contrasts
between cells. Here I provide a brief overview of how the output of
<code>ANOVA_exact()</code> can be used to perform power analyses for
tailored planned contrasts and follow-up tests.</p>
<div id="a-note-of-caution" class="section level1">
<h1>A note of caution</h1>
<p>All power analyses for <code>emmeans</code>-objects are based on the
<span class="math inline">\(F\)</span>- and <span class="math inline">\(t\)</span>-values from the analyses of the dataset
simulated by <code>ANOVA_exact()</code> assuming two-sided testing.
Thus, the <code>emmeans_power()</code> does not honor adjustments of the
testing procedure due to either one-sided testing (including two
one-sided tests) or corrections for multiple comparisons via the
<code>adjust</code> option in <code>emmeans</code>. As noted below, for
the Bonferroni-adjustment this limitation can be overcome by manually
adjusting <code>alpha_level</code>.</p>
</div>
<div id="post-hoc-pairwise-comparisons" class="section level1">
<h1>Post hoc pairwise comparisons</h1>
<p>First, we will set up a 2 <span class="math inline">\(\times\)</span>
3 repeated measures design. When calling <code>ANOVA_exact()</code>
pairwise comparisons of expected marginal means are added by setting
<code>emm = TRUE</code> and <code>contrast_type = &quot;pairwise&quot;</code>
(default).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Set up a within design with 2 factors, each with 2 and 3 levels</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="at">design =</span> <span class="st">&quot;2w*3w&quot;</span>,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">40</span>,</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="at">mu =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="at">sd =</span> <span class="dv">2</span>,</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  <span class="at">r =</span> <span class="fl">0.8</span>, </span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  <span class="at">label_list =</span> <span class="fu">list</span>(<span class="st">&quot;condition&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;cheerful&quot;</span>, <span class="st">&quot;sad&quot;</span>),  </span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>                    <span class="st">&quot;voice&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;human&quot;</span>, <span class="st">&quot;robot&quot;</span>, <span class="st">&quot;cartoon&quot;</span>))</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_exact</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  design_result,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="at">alpha_level =</span> <span class="fl">0.05</span>,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="at">emm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="at">contrast_type =</span> <span class="st">&quot;pairwise&quot;</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>)</span></code></pre></div>
<p>The result contains the power calculations for both the omnibus <span class="math inline">\(F\)</span>-tests and pairwise post-hoc
comparisons.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>exact_result<span class="sc">$</span>main_results</span></code></pre></div>
<div class="kable-table">
<table style="width:100%;">
<colgroup>
<col width="22%" />
<col width="12%" />
<col width="28%" />
<col width="14%" />
<col width="21%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">power</th>
<th align="right">partial_eta_squared</th>
<th align="right">cohen_f</th>
<th align="right">non_centrality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">condition</td>
<td align="right">29.08380</td>
<td align="right">0.0507099</td>
<td align="right">0.2311251</td>
<td align="right">2.083333</td>
</tr>
<tr class="even">
<td align="left">voice</td>
<td align="right">50.12584</td>
<td align="right">0.0621242</td>
<td align="right">0.2573700</td>
<td align="right">5.166667</td>
</tr>
<tr class="odd">
<td align="left">condition:voice</td>
<td align="right">41.62968</td>
<td align="right">0.0507099</td>
<td align="right">0.2311251</td>
<td align="right">4.166667</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">head</span>(exact_result<span class="sc">$</span>emm_results)</span></code></pre></div>
<div class="kable-table">
<table>
<colgroup>
<col width="55%" />
<col width="7%" />
<col width="16%" />
<col width="8%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="right">power</th>
<th align="right">partial_eta_squared</th>
<th align="right">cohen_f</th>
<th align="right">non_centrality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">condition_cheerful voice_cartoon - condition_sad
voice_cartoon</td>
<td align="right">68.37160</td>
<td align="right">0.1381215</td>
<td align="right">0.4003204</td>
<td align="right">6.25</td>
</tr>
<tr class="even">
<td align="left">condition_cheerful voice_cartoon - condition_cheerful
voice_human</td>
<td align="right">16.41134</td>
<td align="right">0.0250000</td>
<td align="right">0.1601282</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">condition_cheerful voice_cartoon - condition_sad
voice_human</td>
<td align="right">16.41134</td>
<td align="right">0.0250000</td>
<td align="right">0.1601282</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">condition_cheerful voice_cartoon - condition_cheerful
voice_robot</td>
<td align="right">68.37160</td>
<td align="right">0.1381215</td>
<td align="right">0.4003204</td>
<td align="right">6.25</td>
</tr>
<tr class="odd">
<td align="left">condition_cheerful voice_cartoon - condition_sad
voice_robot</td>
<td align="right">68.37160</td>
<td align="right">0.1381215</td>
<td align="right">0.4003204</td>
<td align="right">6.25</td>
</tr>
<tr class="even">
<td align="left">condition_sad voice_cartoon - condition_cheerful
voice_human</td>
<td align="right">30.99652</td>
<td align="right">0.0545455</td>
<td align="right">0.2401922</td>
<td align="right">2.25</td>
</tr>
</tbody>
</table>
</div>
<p>The output also contains the <code>emmeans</code>-object on which
these power calculations are based. By manipulating this object it is
possible to tailor the power analyses to the contrasts desired for the
planned study. That is, based on the dataset simulated with
<code>ANOVA_exact()</code> we can write out the analysis code for
<code>emmeans</code>-contrasts, just as we would if we were to analyze
the empirical data, and use the output to perform the corresponding
power analysis.</p>
</div>
<div id="customized-emmeans-contrasts" class="section level1">
<h1>Customized <code>emmeans</code> contrasts</h1>
<p>The <code>emmeans</code> reference grid and contrasts are included in
the output of <code>ANOVA_exact()</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(exact_result<span class="sc">$</span>emmeans<span class="sc">$</span>emmeans)</span></code></pre></div>
<table>
<colgroup>
<col width="26%" />
<col width="19%" />
<col width="9%" />
<col width="13%" />
<col width="4%" />
<col width="13%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">condition</th>
<th align="left">voice</th>
<th align="right">emmean</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">lower.CL</th>
<th align="right">upper.CL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">condition_cheerful</td>
<td align="left">voice_cartoon</td>
<td align="right">0.5</td>
<td align="right">0.3162278</td>
<td align="right">39</td>
<td align="right">-0.139631</td>
<td align="right">1.139631</td>
</tr>
<tr class="even">
<td align="left">condition_sad</td>
<td align="left">voice_cartoon</td>
<td align="right">0.0</td>
<td align="right">0.3162278</td>
<td align="right">39</td>
<td align="right">-0.639631</td>
<td align="right">0.639631</td>
</tr>
<tr class="odd">
<td align="left">condition_cheerful</td>
<td align="left">voice_human</td>
<td align="right">0.3</td>
<td align="right">0.3162278</td>
<td align="right">39</td>
<td align="right">-0.339631</td>
<td align="right">0.939631</td>
</tr>
<tr class="even">
<td align="left">condition_sad</td>
<td align="left">voice_human</td>
<td align="right">0.3</td>
<td align="right">0.3162278</td>
<td align="right">39</td>
<td align="right">-0.339631</td>
<td align="right">0.939631</td>
</tr>
<tr class="odd">
<td align="left">condition_cheerful</td>
<td align="left">voice_robot</td>
<td align="right">0.0</td>
<td align="right">0.3162278</td>
<td align="right">39</td>
<td align="right">-0.639631</td>
<td align="right">0.639631</td>
</tr>
<tr class="even">
<td align="left">condition_sad</td>
<td align="left">voice_robot</td>
<td align="right">0.0</td>
<td align="right">0.3162278</td>
<td align="right">39</td>
<td align="right">-0.639631</td>
<td align="right">0.639631</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(exact_result<span class="sc">$</span>emmeans<span class="sc">$</span>contrasts)</span></code></pre></div>
<table>
<colgroup>
<col width="66%" />
<col width="9%" />
<col width="4%" />
<col width="3%" />
<col width="8%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">t.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">condition_cheerful voice_cartoon - condition_sad
voice_cartoon</td>
<td align="right">0.5</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">2.5</td>
<td align="right">0.0167338</td>
</tr>
<tr class="even">
<td align="left">condition_cheerful voice_cartoon - condition_cheerful
voice_human</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">1.0</td>
<td align="right">0.3234749</td>
</tr>
<tr class="odd">
<td align="left">condition_cheerful voice_cartoon - condition_sad
voice_human</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">1.0</td>
<td align="right">0.3234749</td>
</tr>
<tr class="even">
<td align="left">condition_cheerful voice_cartoon - condition_cheerful
voice_robot</td>
<td align="right">0.5</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">2.5</td>
<td align="right">0.0167338</td>
</tr>
<tr class="odd">
<td align="left">condition_cheerful voice_cartoon - condition_sad
voice_robot</td>
<td align="right">0.5</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">2.5</td>
<td align="right">0.0167338</td>
</tr>
<tr class="even">
<td align="left">condition_sad voice_cartoon - condition_cheerful
voice_human</td>
<td align="right">-0.3</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">-1.5</td>
<td align="right">0.1416670</td>
</tr>
<tr class="odd">
<td align="left">condition_sad voice_cartoon - condition_sad
voice_human</td>
<td align="right">-0.3</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">-1.5</td>
<td align="right">0.1416670</td>
</tr>
<tr class="even">
<td align="left">condition_sad voice_cartoon - condition_cheerful
voice_robot</td>
<td align="right">0.0</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">0.0</td>
<td align="right">1.0000000</td>
</tr>
<tr class="odd">
<td align="left">condition_sad voice_cartoon - condition_sad
voice_robot</td>
<td align="right">0.0</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">0.0</td>
<td align="right">1.0000000</td>
</tr>
<tr class="even">
<td align="left">condition_cheerful voice_human - condition_sad
voice_human</td>
<td align="right">0.0</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">0.0</td>
<td align="right">1.0000000</td>
</tr>
<tr class="odd">
<td align="left">condition_cheerful voice_human - condition_cheerful
voice_robot</td>
<td align="right">0.3</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">1.5</td>
<td align="right">0.1416670</td>
</tr>
<tr class="even">
<td align="left">condition_cheerful voice_human - condition_sad
voice_robot</td>
<td align="right">0.3</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">1.5</td>
<td align="right">0.1416670</td>
</tr>
<tr class="odd">
<td align="left">condition_sad voice_human - condition_cheerful
voice_robot</td>
<td align="right">0.3</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">1.5</td>
<td align="right">0.1416670</td>
</tr>
<tr class="even">
<td align="left">condition_sad voice_human - condition_sad
voice_robot</td>
<td align="right">0.3</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">1.5</td>
<td align="right">0.1416670</td>
</tr>
<tr class="odd">
<td align="left">condition_cheerful voice_robot - condition_sad
voice_robot</td>
<td align="right">0.0</td>
<td align="right">0.2</td>
<td align="right">39</td>
<td align="right">0.0</td>
<td align="right">1.0000000</td>
</tr>
</tbody>
</table>
<p>By using <code>emmeans_power()</code> on the contrasts, we can
reproduce the results of the previous power analysis for the pairwise
comparisons.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">emmeans_power</span>(exact_result<span class="sc">$</span>emmeans<span class="sc">$</span>contrasts))</span></code></pre></div>
<div class="kable-table">
<table>
<colgroup>
<col width="55%" />
<col width="7%" />
<col width="16%" />
<col width="8%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="right">power</th>
<th align="right">partial_eta_squared</th>
<th align="right">cohen_f</th>
<th align="right">non_centrality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">condition_cheerful voice_cartoon - condition_sad
voice_cartoon</td>
<td align="right">68.37160</td>
<td align="right">0.1381215</td>
<td align="right">0.4003204</td>
<td align="right">6.25</td>
</tr>
<tr class="even">
<td align="left">condition_cheerful voice_cartoon - condition_cheerful
voice_human</td>
<td align="right">16.41134</td>
<td align="right">0.0250000</td>
<td align="right">0.1601282</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">condition_cheerful voice_cartoon - condition_sad
voice_human</td>
<td align="right">16.41134</td>
<td align="right">0.0250000</td>
<td align="right">0.1601282</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">condition_cheerful voice_cartoon - condition_cheerful
voice_robot</td>
<td align="right">68.37160</td>
<td align="right">0.1381215</td>
<td align="right">0.4003204</td>
<td align="right">6.25</td>
</tr>
<tr class="odd">
<td align="left">condition_cheerful voice_cartoon - condition_sad
voice_robot</td>
<td align="right">68.37160</td>
<td align="right">0.1381215</td>
<td align="right">0.4003204</td>
<td align="right">6.25</td>
</tr>
<tr class="even">
<td align="left">condition_sad voice_cartoon - condition_cheerful
voice_human</td>
<td align="right">30.99652</td>
<td align="right">0.0545455</td>
<td align="right">0.2401922</td>
<td align="right">2.25</td>
</tr>
</tbody>
</table>
</div>
<p>Now, we can manipulate the <code>emmeans</code> reference grid to
perform additional power analyses. In the following example, we
calculate the power for the contrasts between sad and cheerful condition
for each voice.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>simple_condition_effects <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  exact_result<span class="sc">$</span>emmeans<span class="sc">$</span>emmeans,</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="at">specs =</span> <span class="sc">~</span> condition <span class="sc">|</span> voice</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="fu">emmeans_power</span>(<span class="fu">pairs</span>(simple_condition_effects))</span></code></pre></div>
<div class="kable-table">
<table>
<colgroup>
<col width="34%" />
<col width="13%" />
<col width="7%" />
<col width="19%" />
<col width="9%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">voice</th>
<th align="right">power</th>
<th align="right">partial_eta_squared</th>
<th align="right">cohen_f</th>
<th align="right">non_centrality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">condition_cheerful - condition_sad</td>
<td align="left">voice_cartoon</td>
<td align="right">68.3716</td>
<td align="right">0.1381215</td>
<td align="right">0.4003204</td>
<td align="right">6.25</td>
</tr>
<tr class="even">
<td align="left">condition_cheerful - condition_sad</td>
<td align="left">voice_human</td>
<td align="right">5.0000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">condition_cheerful - condition_sad</td>
<td align="left">voice_robot</td>
<td align="right">5.0000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table>
</div>
<p>We may also calculate the power for testing all condition means
against an arbitrary constant.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">emmeans_power</span>(<span class="fu">test</span>(simple_condition_effects, <span class="at">null =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<div class="kable-table">
<table>
<colgroup>
<col width="21%" />
<col width="15%" />
<col width="11%" />
<col width="22%" />
<col width="11%" />
<col width="17%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">condition</th>
<th align="left">voice</th>
<th align="right">power</th>
<th align="right">partial_eta_squared</th>
<th align="right">cohen_f</th>
<th align="right">non_centrality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">condition_cheerful</td>
<td align="left">voice_cartoon</td>
<td align="right">5.000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0</td>
</tr>
<tr class="even">
<td align="left">condition_sad</td>
<td align="left">voice_cartoon</td>
<td align="right">33.831141</td>
<td align="right">0.0602410</td>
<td align="right">0.2531848</td>
<td align="right">2.5</td>
</tr>
<tr class="odd">
<td align="left">condition_cheerful</td>
<td align="left">voice_human</td>
<td align="right">9.462673</td>
<td align="right">0.0101523</td>
<td align="right">0.1012739</td>
<td align="right">0.4</td>
</tr>
<tr class="even">
<td align="left">condition_sad</td>
<td align="left">voice_human</td>
<td align="right">9.462673</td>
<td align="right">0.0101523</td>
<td align="right">0.1012739</td>
<td align="right">0.4</td>
</tr>
<tr class="odd">
<td align="left">condition_cheerful</td>
<td align="left">voice_robot</td>
<td align="right">33.831141</td>
<td align="right">0.0602410</td>
<td align="right">0.2531848</td>
<td align="right">2.5</td>
</tr>
<tr class="even">
<td align="left">condition_sad</td>
<td align="left">voice_robot</td>
<td align="right">33.831141</td>
<td align="right">0.0602410</td>
<td align="right">0.2531848</td>
<td align="right">2.5</td>
</tr>
</tbody>
</table>
</div>
<p>Finally, we can calculate the power for custom contrasts between any
linear combination of conditions.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>custom_contrast <span class="ot">&lt;-</span> <span class="fu">contrast</span>(</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  exact_result<span class="sc">$</span>emmeans<span class="sc">$</span>emmeans,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">robot_vs_sad_human =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>))</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="fu">emmeans_power</span>(custom_contrast)</span></code></pre></div>
<div class="kable-table">
<table>
<colgroup>
<col width="26%" />
<col width="12%" />
<col width="27%" />
<col width="13%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="right">power</th>
<th align="right">partial_eta_squared</th>
<th align="right">cohen_f</th>
<th align="right">non_centrality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">robot_vs_sad_human</td>
<td align="right">39.34971</td>
<td align="right">0.0714286</td>
<td align="right">0.2773501</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
</div>
<p>Although <code>emmeans_power()</code> currently ignores adjustments
for multiple comparisons, it is possible to calculate the power for
Bonferroni-corrected tests by adjusting <code>alpha_level</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>n_contrasts <span class="ot">&lt;-</span> <span class="fu">nrow</span>(<span class="fu">as.data.frame</span>(simple_condition_effects))</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="fu">emmeans_power</span>(</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="fu">pairs</span>(simple_condition_effects),</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  <span class="at">alpha_level =</span> <span class="fl">0.05</span> <span class="sc">/</span> n_contrasts</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>)</span></code></pre></div>
<div class="kable-table">
<table>
<colgroup>
<col width="33%" />
<col width="13%" />
<col width="10%" />
<col width="19%" />
<col width="9%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">voice</th>
<th align="right">power</th>
<th align="right">partial_eta_squared</th>
<th align="right">cohen_f</th>
<th align="right">non_centrality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">condition_cheerful - condition_sad</td>
<td align="left">voice_cartoon</td>
<td align="right">40.1555499</td>
<td align="right">0.1381215</td>
<td align="right">0.4003204</td>
<td align="right">6.25</td>
</tr>
<tr class="even">
<td align="left">condition_cheerful - condition_sad</td>
<td align="left">voice_human</td>
<td align="right">0.8333333</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">condition_cheerful - condition_sad</td>
<td align="left">voice_robot</td>
<td align="right">0.8333333</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table>
</div>
<p>Similarly, if we want to calculate power for a one-sided test, we can
doubling <code>alpha_level</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">emmeans_power</span>(</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  <span class="fu">pairs</span>(simple_condition_effects)[<span class="dv">1</span>],</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  <span class="at">alpha_level =</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fl">0.05</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>)</span></code></pre></div>
<div class="kable-table">
<table>
<colgroup>
<col width="33%" />
<col width="13%" />
<col width="8%" />
<col width="19%" />
<col width="9%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">voice</th>
<th align="right">power</th>
<th align="right">partial_eta_squared</th>
<th align="right">cohen_f</th>
<th align="right">non_centrality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">condition_cheerful - condition_sad</td>
<td align="left">voice_cartoon</td>
<td align="right">79.14507</td>
<td align="right">0.1381215</td>
<td align="right">0.4003204</td>
<td align="right">6.25</td>
</tr>
</tbody>
</table>
</div>
<p>Note, that because power is calculated from the squared <span class="math inline">\(t\)</span>-value, power is only calculated
correctly if the alternative hypothesis is true in the simulated
dataset. That is, the difference of the condition means is consistent
with the tested directional hypothesis.</p>
<div id="equivalence-and-non-superiority-inferiority-tests" class="section level2">
<h2>Equivalence and non-superiority/-inferiority tests</h2>
<p>Because <code>emmeans</code> can perform equivalence,
non-superiority, and -inferiority tests, <code>emmeans_power()</code>
can calculate the corresponding power for these tests.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">emmeans_power</span>(</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="fu">pairs</span>(simple_condition_effects, <span class="at">side =</span> <span class="st">&quot;equivalence&quot;</span>, <span class="at">delta =</span> <span class="fl">0.3</span>)[<span class="dv">2</span>]</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>)</span></code></pre></div>
<div class="kable-table">
<table>
<colgroup>
<col width="2%" />
<col width="33%" />
<col width="11%" />
<col width="8%" />
<col width="19%" />
<col width="9%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">contrast</th>
<th align="left">voice</th>
<th align="right">power</th>
<th align="right">partial_eta_squared</th>
<th align="right">cohen_f</th>
<th align="right">non_centrality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2</td>
<td align="left">condition_cheerful - condition_sad</td>
<td align="left">voice_human</td>
<td align="right">30.99652</td>
<td align="right">0.0545455</td>
<td align="right">0.2401922</td>
<td align="right">2.25</td>
</tr>
</tbody>
</table>
</div>
<p>Note, that because power is calculated from the squared <span class="math inline">\(t\)</span>-value, power is only calculated
correctly if the alternative hypothesis is true in the simulated
dataset. That is, the difference between the condition means is
consistent with the tested directional hypothesis (smaller than
<code>delta</code>).</p>
</div>
<div id="joint-tests" class="section level2">
<h2>Joint tests</h2>
<p>Another useful application of <code>emmeans_power()</code> is to
joint tests. Lets assume we plan to test the main effect of voice for
each of the two conditions separately using <code>joint_tests()</code>.
We can then calculate the power for each Bonferroni-corrected <span class="math inline">\(F\)</span>-test as follows.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>voice_by_condition <span class="ot">&lt;-</span> <span class="fu">joint_tests</span>(</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  exact_result<span class="sc">$</span>emmeans<span class="sc">$</span>emmeans,</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">&quot;condition&quot;</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="fu">emmeans_power</span>(voice_by_condition, <span class="at">alpha_level =</span> <span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="kable-table">
<table>
<colgroup>
<col width="3%" />
<col width="12%" />
<col width="21%" />
<col width="10%" />
<col width="22%" />
<col width="11%" />
<col width="17%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">model term</th>
<th align="left">condition</th>
<th align="right">power</th>
<th align="right">partial_eta_squared</th>
<th align="right">cohen_f</th>
<th align="right">non_centrality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">voice</td>
<td align="left">condition_cheerful</td>
<td align="right">21.80102</td>
<td align="right">0.0751061</td>
<td align="right">0.2849651</td>
<td align="right">3.167</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">voice</td>
<td align="left">condition_sad</td>
<td align="right">10.39583</td>
<td align="right">0.0370370</td>
<td align="right">0.1961161</td>
<td align="right">1.500</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
